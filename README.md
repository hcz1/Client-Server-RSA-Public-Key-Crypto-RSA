# Client-Server-RSA-Public-Key-Crypto-RSA

You are part of an underground resistance organisation against Big Brother. You and one of your new recruits, Winston, have come up with a scheme for secure communication

Userids and keys. Each member of this organisation has a userid, which is a simple string like alice, bob etc. There is also a user with userid server that will be needed in Tasks 2 and 3. Each user has a pair of public and private keys of the form userid.pub and userid.prv, where userid is their userid. Those are 2048-bit RSA keys, generated by the program RSAKeyGen.java.

1. Commands to members of the group are distributed in an encrypted file. Each line in the file contains an “encoded userid”, followed by a space character, and then an encrypted message intended for that user. In more detail:
 
• The membership of this organisation is top secret, and even members of the group do not know the identities of most other members. (This way you can never betray more than a few people when you eventually, and inevitably, get arrested.) To protect the identites of the members, userids are encoded by computing the MD5 digest of the userid, converting it to hexadecimal, and take the first 8 hex characters. For example, the encoded userid of winston is a699e397.
• Each message is to be encrypted with RSA/ECB/PKCS1Padding with the relevant RSA key of the recipient, then encoded into a Base64 string.
Server.java produces such an encrypted file. The program reads two files: userid.txt which contains one (unencoded) userid per line, and plaintext.txt containing a message in each line. The i-th line in plaintext.txt is the message for the i-th user in userid.txt. If there are more lines in the plaintext file than the userid file, or vice versa, just ignore those extra lines. The program writes the output to a file named ciphertext.txt. All these txt files are in the same working directory as the Java file.

2. After a while, it was decided that instead of publishing the whole encrypted file, the users will communicate with a client-server system. Client and Server programs as described below.
General client-server architecture. The programs are called called Client.java and Server.java respectively, and must be run by the commands
java Client host port userid
java Server port
Each member of the resistance group uses the client program, and the server program is run by someone with a special userid server.
Server side encryption. On startup (before accepting any client connections) the server reads the userid.txt and plaintext.txt files and produces a ciphertext.txt file, as in Task 1. Then it listens for incoming connections at the port specified in the command line argument.
When a client is connected, the server handles the request, then waits for the next request (i.e., the server never terminates). For simplicity, you can assume that only one client will connect to the server at any one time.
Upon accepting a new client connection, the server receives an encoded userid, finds the encrypted message for that user, and sends that encrypted message to the client.
Client side decryption. The client program connects to the server at the host and port specified in the command line arguments. It then sends its encoded userid to the server. Then it receives an encrypted message, decrypts it, and displays it on screen.

3. Add server authentication to the programs in Task 2. Specifically:
• Use the SHA1withRSA signature algorithm, with the same set of public and private keys of the users. (RSA keys can also be used for signatures.)

• Upon connection of a new user, the server first generates the signature (using the appropriate key) of a message consisting of the string GOLDSTEIN and a timestamp. The timestamp and the signature (but not the GOLDSTEIN string!) are sent to the client. Then it proceeds as in Task 2.
• The client (after sending its encoded userid) receives and verifies the signature. If it does not verify, it disconnects immediately. Otherwise it proceeds as in Task 2, displaying both the received timestamp and the message.
